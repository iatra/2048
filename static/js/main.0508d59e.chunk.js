(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{10:function(e,t,n){e.exports=n(16)},15:function(e,t,n){},16:function(e,t,n){"use strict";n.r(t);var r=n(0),s=n.n(r),a=n(8),i=n(9),u=n(2),o=n(3),c=n(5),d=n(4),l=n(1),h=n(6);var f=function(e){var t=e.value,n=t?t.number:null,r=t?t.isNew?"squareNew":t.isMerged?"squareMerged":"squareOld":"squareDefault";return s.a.createElement("span",{className:r},n)},v=function(e){function t(){return Object(u.a)(this,t),Object(c.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(o.a)(t,[{key:"renderSquare",value:function(e,t){var n=this.props.squares[e][t];return s.a.createElement(f,{value:n,key:"sqr"+e+t,rowIndex:e,colIndex:t})}},{key:"renderRow",value:function(e){var t=this,n=this.props.squares[e];return s.a.createElement("div",{className:"board-row",key:"br"+e},n.map((function(n,r){return t.renderSquare(e,r)})))}},{key:"render",value:function(){var e=this;return s.a.createElement("div",null,this.props.squares.map((function(t,n){return e.renderRow(n)})))}}]),t}(s.a.Component);function m(e){var t={number:e,isNew:!0,isMerged:!1,copy:function(){return function e(t){var n={number:t.number,isNew:t.isNew,isMerged:t.isMerged,copy:function(){return e(n)}};return n}(t)}};return t}function g(e,t){return Math.floor(Math.random()*(t-e+1))+e}function y(e){var t=function(e){for(var t=e.length*e[0].length,n=0;n!==e.length;n++)for(var r=e[n],s=0;s!==r.length;s++)r[s]&&t--;return t}(e);if(0===t)return e;for(var n=9===g(0,9)?4:2,r=g(0,t-1),s=0;s!==e.length;s++)for(var a=e[s],i=0;i!==a.length;i++)if(!a[i]){if(0===r)return e[s][i]=m(n),e;r--}}function b(e){var t=Array(e).fill().map((function(){return Array(e).fill(null)}));return{squares:t=y(y(t)),isMoved:!1,isStarted:!1,score:0,rewinds:0,history:[]}}function p(e,t){if(!function(e,t){for(var n=e.length,r=t.get,s=0;s!==n;s++)for(var a=0;a<n-1;){var i=r(e,s,a),u=r(e,s,a+1);if(i){if(!u)return!0;if(i.number===u.number)return!0;a++}else a++}return!1}(e.squares,t))return{squares:e.squares,isMoved:!1,isStarted:e.isStarted,score:e.score};for(var n=e.squares.map((function(e){return e.map((function(e){return e?e.copy():null}))})),r=e.score,s=n.length,a=t.get,i=t.set,u=0;u!==s;u++){for(var o=w(s),c=s-1;c>=0;c--){var d=a(n,u,c);if(d){d.isNew=!1,d.isMerged=!1;var l=o.getLastNonOccupiedIndex();o.canMerge(d)?(o.merge(),r+=o.mergedSum):(o.occupied++,o.items[l]=d)}}for(var h=0;h!==s;h++)i(n,u,h,o.items[h])}return{squares:n,isMoved:!0,isStarted:!0,score:r}}function w(e){var t={length:e,items:new Array(e),occupied:0,mergedSum:0,mergedTiles:new Set,getLastNonOccupiedIndex:function(){return t.length-t.occupied-1},canMerge:function(e){if(t.occupied>0){var n=t.getLastNonOccupiedIndex()+1;return!t.mergedTiles.has(n)&&e.number===t.items[n].number}return!1},merge:function(){var e=t.getLastNonOccupiedIndex()+1,n=t.items[e];n.number=2*n.number,n.isMerged=!0,t.items[e]=n,t.mergedTiles.add(e),t.mergedSum=n.number}};return t}function E(e,t,n){return e[t][e.length-n-1]}function k(e,t,n,r){e[t][e.length-n-1]=r}function M(e,t,n){return e[e.length-n-1][t]}function S(e,t,n,r){e[e.length-n-1][t]=r}function q(e,t,n){return e[t][n]}function N(e,t,n,r){e[t][n]=r}function O(e,t,n){return e[n][t]}function j(e,t,n,r){e[n][t]=r}function L(e){return p(e,{get:E,set:k})}function I(e){return p(e,{get:q,set:N})}function T(e){return p(e,{get:M,set:S})}function B(e){return p(e,{get:O,set:j})}function x(e){return{squares:e.squares,isMoved:!1,isStarted:e.isStarted,score:e.score}}var C=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(c.a)(this,Object(d.a)(t).call(this,e))).state=b(e.fieldSize),n.rewind=n.rewind.bind(Object(l.a)(n)),n.reset=n.reset.bind(Object(l.a)(n)),n.keyPressed=n.keyPressed.bind(Object(l.a)(n)),n.touchStart=n.touchStart.bind(Object(l.a)(n)),n.touchEnd=n.touchEnd.bind(Object(l.a)(n)),n.handleTouchMove=n.handleTouchMove.bind(Object(l.a)(n)),n}return Object(h.a)(t,e),Object(o.a)(t,[{key:"touchStart",value:function(e){var t=e.touches[0];t&&this.setState((function(){return{touch:{X:t.clientX,Y:t.clientY}}}))}},{key:"touchEnd",value:function(e){var t=function(e,t){var n=e.changedTouches[0];if(!n)return x;var r=n.clientX-t.X,s=n.clientY-t.Y;if(Math.abs(r)>Math.abs(s)){if(r>0)return I;if(r<0)return L}else{if(s>0)return B;if(s<0)return T}return x}(e,this.state.touch);this.handleMove(t)}},{key:"keyPressed",value:function(e){if(81!==e.keyCode){var t=function(e){switch(e.keyCode){case 37:return function(e){return L(e)};case 38:return function(e){return T(e)};case 39:return function(e){return I(e)};case 40:return function(e){return B(e)};default:return function(e){return x(e)}}}(e);this.handleMove(t)}else this.rewind()}},{key:"rewind",value:function(){this.state.history.length>0&&this.setState((function(e){var t=e.history[e.history.length-1],n=t.squares,r=t.score;return e.history.splice(-1,1),{squares:n,score:r,rewinds:e.rewinds+1}}))}},{key:"reset",value:function(){var e=this;this.setState((function(){return b(e.props.fieldSize)}))}},{key:"writeHistory",value:function(e){var t=this,n=e.squares,r=e.score;this.setState((function(){return{history:[].concat(Object(i.a)(t.state.history),[{squares:n,score:r}])}}))}},{key:"handleMove",value:function(e){var t=e(this.state),n=t.squares,r=t.isMoved,s=t.isStarted,a=t.score;if(r)return this.writeHistory({squares:this.state.squares,score:this.state.score}),n=y(n),void this.setState((function(){return{squares:n,isMoved:r,isStarted:s,score:a}}));this.setState((function(){return{isMoved:!1}}))}},{key:"handleTouchMove",value:function(e){e.target.className.includes("square")&&e.preventDefault()}},{key:"componentDidMount",value:function(){document.addEventListener("touchmove",this.handleTouchMove,{passive:!1}),document.addEventListener("keydown",this.keyPressed,!1);var e=document.getElementById("game-board");e.addEventListener("touchstart",this.touchStart,!1),e.addEventListener("touchend",this.touchEnd,!1)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("touchmove",this.handleTouchMove,{passive:!1}),document.removeEventListener("keydown",this.keyPressed,!1);var e=document.getElementById("game-board");e.removeEventListener("touchstart",this.touchStart,!1),e.removeEventListener("touchend",this.touchEnd,!1)}},{key:"render",value:function(){return s.a.createElement("div",{className:"game",id:"game"},s.a.createElement("div",{className:"game-board",id:"game-board"},s.a.createElement("div",{className:"status"},s.a.createElement("span",null,"Score: ",this.state.score)),s.a.createElement("div",{className:"status"},this.state.rewinds>0?s.a.createElement("span",null,"Rewinds used: ",this.state.rewinds):null),s.a.createElement("div",{className:"game-info"},s.a.createElement("span",null,this.state.isStarted&&!this.state.isMoved?"Nothing has moved":null)),s.a.createElement(v,{squares:this.state.squares})),s.a.createElement("div",{className:"game-buttons"},s.a.createElement("ul",null,s.a.createElement("button",{className:"veryBoringButton",onClick:this.reset},"New game"),s.a.createElement("button",{className:"veryBoringButton",onClick:this.rewind},"Rewind"))))}}]),t}(s.a.Component);n(15),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));Object(a.render)(s.a.createElement(C,{fieldSize:4}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[10,1,2]]]);
//# sourceMappingURL=main.0508d59e.chunk.js.map